(function(a){"function"===typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./jsonxml"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a){var p=a.jgrid,H=p.jqID,G=a.fn.jqGrid,S=p.mergeCssClasses,T=p.hasOneFromClasses,J=function(a,Q){return S(p.getRes(p.guiStyles[this.p.guiStyle],a),Q||"")},O=function(a){return J.call(this,"states."+a)},ja=p.feedback,la=p.fullBoolFeedback,M=p.builderFmButon,ka=function(a,p){var d=a[0].style[p];return 0<=
d.indexOf("px")?parseFloat(d):d},ma=function(n,p,d){var m=d.w;p=a(p);var h=this.closest(".ui-jqgrid"),c=function(a){return m.parent().hasClass("ui-jqgrid")?(a=m[0].style[a],null!=a&&0<=a.indexOf("px")?parseFloat(a):a):m.offset()[a]-(h.offsetParent().offset()[a]+h.offset()[a]+h.position()[a]+parseFloat(h.css("border-"+a+"-width")||0))};this.data(n,{top:c("top"),left:c("left"),width:ka(m,"width"),height:ka(m,"height"),dataheight:ka(p,"height")||"auto",datawidth:ka(p,"width")||"auto"});m.remove();d.o&&
d.o.remove()},ca=function(a,p,d){!0===p[0]&&(d="<span class='"+S("fm-button-icon",d,p[2])+"'></span>","right"===p[1]?a.addClass("fm-button-icon-right").append(d):a.addClass("fm-button-icon-left").prepend(d))},ia=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};p.extend({searchGrid:function(n){return this.each(function(){function Q(b){t("beforeShow",b)&&(a(v).data("onClose",c.onClose),p.viewModal.call(d,v,{gbox:E,jqm:c.jqModal,overlay:c.overlay,modal:c.modal,overlayClass:c.overlayClass,
toTop:c.toTop,onHide:function(a){ma.call(m,"searchProp",e,a)}}),t("afterShow",b))}var d=this,m=a(d),h=d.p;if(d.grid&&null!=h){var c=a.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,
resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},G.getGridRes.call(m,"search"),p.search||{},h.searching||{},n||{}),e="fbox_"+h.id,
k=c.commonIconClass,l={themodal:"searchmod"+e,modalhead:"searchhd"+e,modalcontent:"searchcnt"+e,resizeAlso:e},v="#"+H(l.themodal),E=h.gBox,f=h.gView,r=a.each,u=h.postData[c.sFilter],t=function(){var b=a.makeArray(arguments);b.unshift("Search");b.unshift("Filter");b.unshift(c);return ja.apply(d,b)};"string"===typeof u&&(u=""!==a.trim(u)?p.parse(u):void 0);!0===c.recreateFilter?a(v).remove():m.data("searchProp")&&a.extend(c,m.data("searchProp"));if(void 0!==a(v)[0])Q(a("#fbox_"+h.idSel));else{var z=
a("<div><div id='"+e+"' class='"+J.call(d,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(f);"rtl"===h.direction&&z.attr("dir","rtl");var L="",F="",b,y=!1,K,x=-1,C=a.extend([],h.colModel);K=M.call(d,e+"_search",c.Find,S(k,c.findDialogIcon),"right");var A=M.call(d,e+"_reset",c.Reset,S(k,c.resetDialogIcon),"left");c.showQuery&&(L=M.call(d,e+"_query","Query",S(k,c.queryDialogIcon),"left")+"&#160;");c.searchForAdditionalProperties&&r(h.additionalProperties,function(){var a=
"string"===typeof this?{name:this}:this;a.label||(a.label=a.name);a.isAddProp=!0;C.push(a)});c.columns.length?(C=c.columns,x=0,b=C[0].index||C[0].name):r(C,function(a,c){c.label||(c.label=c.isAddProp?c.name:h.colNames[a]);if(!y){var e=void 0===c.search?!0:c.search,f=!0===c.hidden;if(c.searchoptions&&!0===c.searchoptions.searchhidden&&e||e&&!f)y=!0,b=c.index||c.name,x=a}});if(!u&&b||!1===c.multipleSearch)k="eq",0<=x&&C[x].searchoptions&&C[x].searchoptions.sopt?k=C[x].searchoptions.sopt[0]:c.sopt&&
c.sopt.length&&(k=c.sopt[0]),u={groupOp:"AND",rules:[{field:b,op:k,data:""}]};y=!1;c.tmplNames&&c.tmplNames.length&&(y=!0,F=c.tmplLabel,F+="<select class='ui-template'>",F+="<option value='default'>Default</option>",r(c.tmplNames,function(a,b){F+="<option value='"+a+"'>"+b+"</option>"}),F+="</select>");K="<div class='"+J.call(d,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+e+"_2'><tbody><tr><td colspan='2'><hr class='"+J.call(d,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+
h.direction+"'  style='float:"+("rtl"===h.direction?"right":"left")+";'>"+A+F+"</td><td class='EditButton EditButton-"+h.direction+"'>"+L+K+"</td></tr></tbody></table></div>";e=H(e);c.gbox="#gbox_"+e;c.height="auto";e="#"+e;a(e).jqFilter({columns:C,filter:c.loadDefaults?u:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,ruleButtons:c.multipleSearch,afterRedraw:c.afterRedraw,ops:c.odata,cops:h.customSortOperations,operands:c.operands,ajaxSelectOptions:h.ajaxSelectOptions,
groupOps:c.groupOps,onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString());la.call(d,c.afterChange,"jqGridFilterAfterChange",a(e),c)},direction:h.direction,id:h.id});z.append(K);y&&c.tmplFilters&&c.tmplFilters.length&&a(".ui-template",z).bind("change",function(){var b=a(this).val();"default"===b?a(e).jqFilter("addFilter",u):a(e).jqFilter("addFilter",c.tmplFilters[parseInt(b,10)]);return!1});!0===c.multipleGroup&&(c.multipleSearch=!0);t("onInitialize",a(e));c.layer?
p.createModal.call(d,l,z,c,f,a(E)[0],"#"+H(c.layer),{position:"relative"}):p.createModal.call(d,l,z,c,f,a(E)[0]);(c.searchOnEnter||c.closeOnEscape)&&a(v).keydown(function(b){var f=a(b.target);if(!(!c.searchOnEnter||13!==b.which||f.hasClass("add-group")||f.hasClass("add-rule")||f.hasClass("delete-group")||f.hasClass("delete-rule")||f.hasClass("fm-button")&&f.is("[id$=_query]")))return a(e+"_search").click(),!1;if(c.closeOnEscape&&27===b.which)return a("#"+H(l.modalhead)).find(".ui-jqdialog-titlebar-close").click(),
!1});L&&a(e+"_query").bind("click",function(){a(".queryresult",z).toggle();return!1});void 0===c.stringResult&&(c.stringResult=c.multipleSearch);a(e+"_search").bind("click",function(){var b={},f,l,t=a(e);l=t.find(".input-elm");l.filter(":focus")&&(l=l.filter(":focus"));l.change();l=t.jqFilter("filterData");if(c.errorcheck&&(t[0].hideError(),c.showQuery||t.jqFilter("toSQLString"),t[0].p.error))return t[0].showError(),!1;if(c.stringResult||"local"===h.datatype){try{f=xmlJsonClass.toJson(l,"","",!1)}catch(k){try{f=
JSON.stringify(l)}catch(n){}}"string"===typeof f&&(b[c.sFilter]=f,r([c.sField,c.sValue,c.sOper],function(){b[this]=""}))}else c.multipleSearch?(b[c.sFilter]=l,r([c.sField,c.sValue,c.sOper],function(){b[this]=""})):(b[c.sField]=l.rules[0].field,b[c.sValue]=l.rules[0].data,b[c.sOper]=l.rules[0].op,b[c.sFilter]="");h.search=!0;a.extend(h.postData,b);la.call(d,c.onSearch,"jqGridFilterSearch",h.filters)&&m.trigger("reloadGrid",[a.extend({page:1},c.reloadGridSearchOptions||{})]);c.closeAfterSearch&&p.hideModal(v,
{gb:E,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal});return!1});a(e+"_reset").bind("click",function(){var b={},f=a(e);h.search=!1;h.resetsearch=!0;!1===c.multipleSearch?b[c.sField]=b[c.sValue]=b[c.sOper]="":b[c.sFilter]="";f[0].resetFilter();y&&a(".ui-template",z).val("default");a.extend(h.postData,b);la.call(d,c.onReset,"jqGridFilterReset")&&m.trigger("reloadGrid",[a.extend({page:1},c.reloadGridResetOptions||{})]);c.closeAfterReset&&p.hideModal(v,{gb:E,jqm:c.jqModal,onClose:c.onClose,
removemodal:c.removemodal});return!1});Q(a(e));var B=O.call(d,"hover");a(".fm-button:not(."+O.call(d,"disabled").split(" ").join(".")+")",z).hover(function(){a(this).addClass(B)},function(){a(this).removeClass(B)})}}})},editGridRow:function(n,Q){return this.each(function(){function d(){a(C+" > tbody > tr > td .FormElement").each(function(){var q=a(".customelement",this),c=this.name;if(q.length){if(c=q.attr("name"),q=da[c],void 0!==q&&(q=N[q],q=q.editoptions||{},a.isFunction(q.custom_value))){try{if(g[c]=
q.custom_value.call(r,a("#"+H(c),C),"get"),void 0===g[c])throw"e1";}catch(f){"e1"===f?p.info_dialog.call(r,ea,"function 'custom_value' "+b.msg.novalue,b.bClose):p.info_dialog.call(r,ea,f.message,b.bClose)}return!0}}else switch(q=a(this)[0].type,q){case "checkbox":g[c]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case "select-one":g[c]=a("option:selected",this).val();break;case "select-multiple":g[c]=a(this).val();g[c]=g[c]?g[c].join(","):"";a("option:selected",this).each(function(b,
q){a(q).text()});break;case "date":g[c]=a(this).val();3===String(g[c]).split("-").length&&(q=da[c],void 0!==q&&(q=N[q],q=q.formatoptions||{},q=q.newformat||L.call(u,"formatter.date.newformat"),g[c]=p.parseDate.call(u[0],"Y-m-d",g[c],q)));break;default:void 0!==q&&0>a.inArray(q,b.skipPostTypes)&&(g[c]=a(this).val())}});return!0}function m(q,c,g){var f=0,e=[],d=!1,l="",h;for(h=1;h<=g;h++)l+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!==q&&(d=G.getInd.call(u,q));a(N).each(function(h){var m=
this.name,k,n,A,u,w;k=this.editable;var v=!1,D=!1;w="_empty"===q?"addForm":"editForm";a.isFunction(k)&&(k=k.call(r,{rowid:q,iCol:h,iRow:d,cmName:m,cm:this,mode:w}));u=(this.editrules&&!0===this.editrules.edithidden?0:!0===this.hidden||"hidden"===k)?"style='display:none'":"";switch(String(k).toLowerCase()){case "hidden":k=!0;break;case "disabled":v=k=!0;break;case "readonly":D=k=!0}if("cb"!==m&&"subgrid"!==m&&!0===k&&"rn"!==m){if(!1===d)A="";else{k=a(r.rows[d].cells[h]);try{A=a.unformat.call(r,k,{rowId:q,
colModel:this},h)}catch(x){A=this.edittype&&"textarea"===this.edittype?k.text():k.html()}ia(A)&&(A="")}k=a.extend({},this.editoptions||{},{id:m,name:m,rowId:q,mode:w});var B=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),z=parseInt(B.rowpos,10)||f+1,V=parseInt(2*(parseInt(B.colpos,10)||1),10);"_empty"===q&&k.defaultValue&&(A=a.isFunction(k.defaultValue)?k.defaultValue.call(r):k.defaultValue);this.edittype||(this.edittype="text");t.autoEncodeOnEdit&&(A=p.oldDecodePostedData(A));
w=p.createEl.call(r,this.edittype,k,A,!1,a.extend({},p.ajaxOptions,t.ajaxSelectOptions||{}));if(b.checkOnSubmit||b.checkOnUpdate)b._savedData[m]=A;a(w).addClass("FormElement");-1<a.inArray(this.edittype,["text","textarea","password","select"])&&a(w).addClass(J.call(r,"dialog.dataField"));n=a(c).find("tr[data-rowpos="+z+"]");if(B.rowabove){var C=a("<tr><td class='contentinfo' colspan='"+2*g+"'>"+B.rowcontent+"</td></tr>");a(c).append(C);C[0].rp=z}0===n.length&&(n=a("<tr "+u+" data-rowpos='"+z+"'></tr>").addClass("FormData").attr("id",
"tr_"+m),a(n).append(l),a(c).append(n),n[0].rp=z);u=a("td:eq("+(V-2)+")",n[0]);n=a("td:eq("+(V-1)+")",n[0]);u.html(void 0===B.label?t.colNames[h]:B.label||"&#160;");n[ia(n.html())?"html":"append"](B.elmprefix).append(w).append(B.elmsuffix);v?(u.addClass(P),n.addClass(P),a(w).prop("readonly",!0),a(w).prop("disabled",!0)):D&&a(w).prop("readonly",!0);"custom"===this.edittype&&a.isFunction(k.custom_value)&&k.custom_value.call(r,a("#"+H(m),y),"set",A);p.bindEv.call(r,w,k);e[f]=h;f++}});0<f&&(h=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+
(2*g-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+z+"_id' value='"+q+"'/></td></tr>"),h[0].rp=f+999,a(c).append(h),b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[z+"_id"]=q);return e}function h(q,c){var g,f=0,e,d,h,l,k;if(b.checkOnSubmit||b.checkOnUpdate)b._savedData={},b._savedData[z+"_id"]=q;var m=t.colModel;if("_empty"===q)a(m).each(function(){g=this.name;h=a.extend({},this.editoptions||{});(d=a("#"+H(g),c))&&d.length&&null!==d[0]&&(l="","custom"===this.edittype&&
a.isFunction(h.custom_value)?h.custom_value.call(r,d,"set",l):h.defaultValue?(l=a.isFunction(h.defaultValue)?h.defaultValue.call(r):h.defaultValue,"checkbox"===d[0].type?(k=l.toLowerCase(),0>k.search(/(false|f|0|no|n|off|undefined)/i)&&""!==k?(d[0].checked=!0,d[0].defaultChecked=!0,d[0].value=l):(d[0].checked=!1,d[0].defaultChecked=!1)):d.val(l)):"checkbox"===d[0].type?(d[0].checked=!1,d[0].defaultChecked=!1,l=a(d).data("offval")):d[0].type&&"select"===d[0].type.substr(0,6)?d[0].selectedIndex=0:d.val(l),
!0===b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[g]=l)}),a("#id_g",c).val(q);else{var n=G.getInd.call(u,q,!0);n&&(a(n.cells).filter("td[role=gridcell]").each(function(d){g=m[d].name;if("cb"!==g&&"subgrid"!==g&&"rn"!==g&&!0===m[d].editable){try{e=a.unformat.call(r,a(this),{rowId:q,colModel:m[d]},d)}catch(l){e="textarea"===m[d].edittype?a(this).text():a(this).html()}t.autoEncodeOnEdit&&(e=p.oldDecodePostedData(e));if(!0===b.checkOnSubmit||b.checkOnUpdate)b._savedData[g]=e;g="#"+H(g);switch(m[d].edittype){case "password":case "text":case "button":case "image":case "textarea":ia(e)&&
(e="");a(g,c).val(e);break;case "select":var h=e.split(","),h=a.map(h,function(b){return a.trim(b)});a(g+" option",c).each(function(){var b=a(this),g=a.trim(b.val()),b=a.trim(b.text());m[d].editoptions.multiple||a.trim(e)!==b&&h[0]!==b&&h[0]!==g?m[d].editoptions.multiple?-1<a.inArray(b,h)||-1<a.inArray(g,h)?this.selected=!0:this.selected=!1:this.selected=!1:this.selected=!0});break;case "checkbox":e=String(e);if(m[d].editoptions&&m[d].editoptions.value)if(m[d].editoptions.value.split(":")[0]===e)a(g,
c)[R]({checked:!0,defaultChecked:!0});else a(g,c)[R]({checked:!1,defaultChecked:!1});else e=e.toLowerCase(),0>e.search(/(false|f|0|no|n|off|undefined)/i)&&""!==e?(a(g,c)[R]("checked",!0),a(g,c)[R]("defaultChecked",!0)):(a(g,c)[R]("checked",!1),a(g,c)[R]("defaultChecked",!1));break;case "custom":try{if(m[d].editoptions&&a.isFunction(m[d].editoptions.custom_value))m[d].editoptions.custom_value.call(r,a(g,c),"set",e);else throw"e1";}catch(l){"e1"===l?p.info_dialog.call(r,ea,"function 'custom_value' "+
b.msg.nodefined,b.bClose):p.info_dialog.call(r,ea,l.message,b.bClose)}}f++}}),0<f&&a("#id_g",C).val(q))}}function c(){var c=b.url||t.editurl;a.each(N,function(b,d){var e=d.name,f=g[e];"date"!==d.formatter||null!=d.formatoptions&&!0===d.formatoptions.sendFormatted||(g[e]=a.unformat.date.call(r,f,d));"clientArray"!==c&&d.editoptions&&!0===d.editoptions.NullIfEmpty&&g.hasOwnProperty(e)&&""===f&&(g[e]="null")})}function e(){var q=[!0,"",""],d={},e=t.prmNames,f,l,m,k,v,B,x=G.getInd.call(u,n),V=!1===x?
null:r.rows[x];(B=u.triggerHandler("jqGridAddEditBeforeCheckValues",[a(y),I]))&&"object"===typeof B&&(g=B);x=!1===x?-1:x;a.isFunction(b.beforeCheckValues)&&(B=b.beforeCheckValues.call(r,g,a(y),I))&&"object"===typeof B&&(g=B);for(m in g)if(g.hasOwnProperty(m)&&(B=t.iColByName[m],q=p.checkValues.call(r,g[m],m,void 0,void 0,{oldValue:"_empty"===n?null:G.getCell.call(u,n,B),newValue:g[m],cmName:m,rowid:n,cm:N[B],iCol:B,iRow:x,tr:V,td:null==V?null:V.cells[B],mode:"_empty"===n?"addForm":"editForm"}),!1===
q[0]))break;c();q[0]&&(d=u.triggerHandler("jqGridAddEditClickSubmit",[b,g,I]),void 0===d&&a.isFunction(b.onclickSubmit)&&(d=b.onclickSubmit.call(r,b,g,I)||{}),q=u.triggerHandler("jqGridAddEditBeforeSubmit",[g,a(y),I]),null==q&&(q=[!0,"",""]),q[0]&&a.isFunction(b.beforeSubmit)&&(q=b.beforeSubmit.call(r,g,a(y),I),null==q&&(q=[!0,"",""])));if(q[0]&&!b.processing){b.processing=!0;a("#sData",A).addClass(qa);m=b.url||t.editurl;l=e.oper;f="clientArray"===m&&!1!==t.keyName?t.keyName:e.id;g[l]="_empty"===
a.trim(g[z+"_id"])?e.addoper:e.editoper;g[l]!==e.addoper?g[f]=g[z+"_id"]:void 0===g[f]&&(g[f]=g[z+"_id"]);delete g[z+"_id"];g=a.extend(g,b.editData,d);if(!0===t.treeGrid)for(v in g[l]===e.addoper&&(k=t.selrow,g["adjacency"===t.treeGridModel?t.treeReader.parent_id_field:"parent_id"]=k),t.treeReader)t.treeReader.hasOwnProperty(v)&&(d=t.treeReader[v],!g.hasOwnProperty(d)||g[l]===e.addoper&&"parent_id_field"===v||delete g[d]);g[f]=p.stripPref(t.idPrefix,g[f]);t.autoEncodeOnEdit&&a.each(g,function(b,c){a.isFunction(c)||
(g[b]=p.oldEncodePostedData(c))});v=a.extend({url:a.isFunction(m)?m.call(r,g[f],I,g,b):m,type:a.isFunction(b.mtype)?b.mtype.call(r,I,b,g[f],g):b.mtype,data:p.serializeFeedback.call(r,a.isFunction(b.serializeEditData)?b.serializeEditData:t.serializeEditData,"jqGridAddEditSerializeEditData",g),complete:function(c,d){a("#sData",A).removeClass(qa);g[f]=t.idPrefix+a("#id_g",C).val();300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(q[0]=!1,q[1]=u.triggerHandler("jqGridAddEditErrorTextFormat",
[c,I]),a.isFunction(b.errorTextFormat)?q[1]=b.errorTextFormat.call(r,c,I):q[1]=d+" Status: '"+c.statusText+"'. Error code: "+c.status):(q=u.triggerHandler("jqGridAddEditAfterSubmit",[c,g,I]),null==q&&(q=[!0,"",""]),q[0]&&a.isFunction(b.afterSubmit)&&(q=b.afterSubmit.call(r,c,g,I),null==q&&(q=[!0,"",""])));if(!1===q[0])a("#FormError>td",C).html(q[1]),a("#FormError",C).show();else{t.autoEncodeOnEdit&&a.each(g,function(a,b){g[a]=p.oldDecodePostedData(b)});var m=[a.extend({},b.reloadGridOptions||{})];
g[l]===e.addoper?(q[2]||(q[2]=p.randId()),null==g[f]||"_empty"===g[f]||g[l]===e.addoper?g[f]=q[2]:q[2]=g[f],b.reloadAfterSubmit?u.trigger("reloadGrid",m):!0===t.treeGrid?G.addChildNode.call(u,q[2],k,g):G.addRowData.call(u,q[2],g,b.addedrow),b.closeAfterAdd?(!0!==t.treeGrid&&F.call(u,q[2]),U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form})):b.clearAfterAdd&&h("_empty",y)):(b.reloadAfterSubmit?(u.trigger("reloadGrid",m),b.closeAfterEdit||setTimeout(function(){F.call(u,
g[f])},1E3)):!0===t.treeGrid?G.setTreeRow.call(u,g[f],g):G.setRowData.call(u,g[f],g),b.closeAfterEdit&&U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}));if(a.isFunction(b.afterComplete)){var n=c;setTimeout(function(){u.triggerHandler("jqGridAddEditAfterComplete",[n,g,a(y),I]);b.afterComplete.call(r,n,g,a(y),I);n=null},50)}if(b.checkOnSubmit||b.checkOnUpdate)if(a(y).data("disabled",!1),"_empty"!==b._savedData[z+"_id"])for(var v in b._savedData)b._savedData.hasOwnProperty(v)&&
g[v]&&(b._savedData[v]=g[v])}b.processing=!1;try{a(":input:visible",y)[0].focus()}catch(B){}}},p.ajaxOptions,b.ajaxEditOptions);v.url||b.useDataProxy||(a.isFunction(t.dataProxy)?b.useDataProxy=!0:(q[0]=!1,q[1]+=" "+p.errors.nourl));q[0]&&(b.useDataProxy?(d=t.dataProxy.call(r,v,"set_"+z),void 0===d&&(d=[!0,""]),!1===d[0]?(q[0]=!1,q[1]=d[1]||"Error deleting the selected row!"):(v.data.oper===e.addoper&&b.closeAfterAdd&&U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,
form:b.form}),v.data.oper===e.editoper&&b.closeAfterEdit&&U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form}))):"clientArray"===v.url?(b.reloadAfterSubmit=!1,g=v.data,v.complete({status:200,statusText:""},"")):a.ajax(v))}!1===q[0]&&(a("#FormError>td",C).html(q[1]),a("#FormError",C).show())}function k(a,b){var c=!1,g;for(g in a)if(a.hasOwnProperty(g)&&String(a[g])!==String(b[g])){c=!0;break}return c}function l(){var c=!0;a("#FormError",C).hide();
b.checkOnUpdate&&(g={},d(),V=k(g,b._savedData))&&(a(y).data("disabled",!0),a(".confirm",w).show(),c=!1);return c}function v(){var b=p.detectRowEditing.call(r,n);if(null!=b)if("inlineEditing"===b.mode)G.restoreRow.call(u,n);else{var b=b.savedRow,c=r.rows[b.id];G.restoreCell.call(u,b.id,b.ic);a(c.cells[b.ic]).removeClass("edit-cell "+ra);a(c).addClass(ra).attr({"aria-selected":"true",tabindex:"0"})}}function E(b,c){var g=c[1].length-1;0===b?a("#pData",A).addClass(P):void 0!==c[1][b-1]&&T(a("#"+H(c[1][b-
1])),P)?a("#pData",A).addClass(P):a("#pData",A).removeClass(P);b===g?a("#nData",A).addClass(P):void 0!==c[1][b+1]&&T(a("#"+H(c[1][b+1])),P)?a("#nData",A).addClass(P):a("#nData",A).removeClass(P)}function f(){var b=G.getDataIDs.call(u),c=a("#id_g",C).val();return[a.inArray(c,b),b]}var r=this,u=a(r),t=r.p;if(r.grid&&null!=t&&n){var z=t.id,L=G.getGridRes,F=G.setSelection,b=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,
closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:J.call(this,
"overlay"),removemodal:!0,skipPostTypes:["image","file"],form:"edit"},L.call(u,"edit"),p.edit,t.formEditing||{},Q||{}),y="FrmGrid_"+z,K=y,x="TblGrid_"+z,C="#"+H(x),A=C+"_2",B={themodal:"editmod"+z,modalhead:"edithd"+z,modalcontent:"editcnt"+z,resizeAlso:y},w="#"+H(B.themodal),D=t.gBox,R=t.propOrAttr,N=t.colModel,da=t.iColByName,Y=1,Z=0,g,V,I,fa=b.commonIconClass,U=p.hideModal,ea=L.call(u,"errors.errcap"),W=function(){var c=a.makeArray(arguments);c.unshift("");c.unshift("AddEdit");c.unshift(b);return ja.apply(r,
c)},sa=O.call(r,"hover"),P=O.call(r,"disabled"),ra=O.call(r,"select"),qa=O.call(r,"active"),X=O.call(r,"error"),y="#"+H(y);"new"===n?(n="_empty",I="add",b.caption=b.addCaption):(b.caption=b.editCaption,I="edit");if(!b.recreateForm){var aa=u.data("formProp");aa&&(aa.top=Math.max(aa.top,0),aa.left=Math.max(aa.left,0),a.extend(b,aa))}aa=!0;!b.checkOnUpdate||!0!==b.jqModal&&void 0!==b.jqModal||b.modal||(aa=!1);var ga=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",ba=isNaN(b.datawidth)?b.datawidth:
b.datawidth+"px",K=a("<form name='FormPost' id='"+K+"' class='FormGrid' onSubmit='return false;' style='width:"+ba+";overflow:auto;position:relative;height:"+ga+";'></form>").data("disabled",!1),ha=a("<table id='"+x+"' class='EditTable'"+(p.msie&&8>p.msiever()?" cellspacing='0'":"")+"><tbody></tbody></table>");a(N).each(function(){var a=this.formoptions;Y=Math.max(Y,a?a.colpos||0:0);Z=Math.max(Z,a?a.rowpos||0:0)});a(K).append(ha);X=a("<tr id='FormError' style='display:none'><td class='"+X+"' colspan='"+
2*Y+"'>&#160;</td></tr>");X[0].rp=0;a(ha).append(X);X=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*Y+"'>"+(b.topinfo||"&#160;")+"</td></tr>");X[0].rp=0;a(ha).append(X);if(W("beforeInitData",K,I)){v();ga=(X="rtl"===t.direction?!0:!1)?"nData":"pData";ba=X?"pData":"nData";m(n,ha,Y);var ga=M.call(r,ga,"",S(fa,b.prevIcon),"","left"),ba=M.call(r,ba,"",S(fa,b.nextIcon),"","right"),na=M.call(r,"sData",b.bSubmit),oa=M.call(r,"cData",b.bCancel),x="<div class='"+J.call(r,"dialog.footer")+
"'><table"+(p.msie&&8>p.msiever()?" cellspacing='0'":"")+" class='EditTable' id='"+x+"_2'><tbody><tr><td colspan='2'><hr class='"+J.call(r,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+t.direction+"'>"+(X?ba+ga:ga+ba)+"</td><td class='EditButton EditButton-"+t.direction+"'>"+na+"&#160;"+oa+"</td></tr>",x=x+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(b.bottominfo||"&#160;")+"</td></tr>"),x=x+"</tbody></table></div>";
if(0<Z){var pa=[];a.each(a(ha)[0].rows,function(a,b){pa[a]=b});pa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(pa,function(b,c){a("tbody",ha).append(c)})}b.gbox=D;var ta=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,ta=!0);x=a("<div></div>").append(a("<div class='"+J.call(r,"dialog.body")+"'></div>").append(K)).append(x);p.createModal.call(r,B,x,b,t.gView,a(D)[0]);b.topinfo&&a(".tinfo",C).show();b.bottominfo&&a(".binfo",A).show();x=x=null;a(w).keydown(function(c){var g=(c.target.tagName||
"").toUpperCase(),d,f;if(!0===a(y).data("disabled"))return!1;if(13===c.which&&"TEXTAREA"!==g){d=a(A).find(":focus");f=d.attr("id");if(0<d.length&&0<=a.inArray(f,["pData","nData","cData"]))return d.trigger("click"),!1;if(!0===b.savekey[0]&&13===b.savekey[1])return a("#sData",A).trigger("click"),!1}if(!0===b.savekey[0]&&c.which===b.savekey[1]&&"TEXTAREA"!==g)return a("#sData",A).trigger("click"),!1;if(27===c.which){if(!l())return!1;ta&&U(w,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,
formprop:!b.recreateForm,form:b.form});return!1}if(!0===b.navkeys[0]){if("_empty"===a("#id_g",C).val())return!0;if(c.which===b.navkeys[1])return a("#pData",A).trigger("click"),!1;if(c.which===b.navkeys[2])return a("#nData",A).trigger("click"),!1}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",w).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close",w).unbind("click").click(function(){if(!l())return!1;U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,
form:b.form});return!1}));ca(a("#sData",A),b.saveicon,fa);ca(a("#cData",A),b.closeicon,fa);if(b.checkOnSubmit||b.checkOnUpdate)na=M.call(r,"sNew",b.bYes),ba=M.call(r,"nNew",b.bNo),oa=M.call(r,"cNew",b.bExit),B=b.zIndex||999,B++,a("<div class='"+b.overlayClass+" jqgrid-overlay confirm' style='z-index:"+B+";display:none;'>&#160;</div><div class='"+J.call(r,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(B+1)+"'>"+b.saveData+"<br/><br/>"+na+ba+oa+"</div>").insertAfter(y),a("#sNew",w).click(function(){e();
a(y).data("disabled",!1);a(".confirm",w).hide();return!1}),a("#nNew",w).click(function(){a(".confirm",w).hide();a(y).data("disabled",!1);setTimeout(function(){a(":input:visible",y)[0].focus()},0);return!1}),a("#cNew",w).click(function(){a(".confirm",w).hide();a(y).data("disabled",!1);U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});W("onInitializeForm",a(y),I);"_empty"!==n&&b.viewPagerButtons?a("#pData,#nData",A).show():a("#pData,#nData",
A).hide();W("beforeShowForm",a(y),I);a(w).data("onClose",b.onClose);p.viewModal.call(r,w,{gbox:D,jqm:b.jqModal,overlay:b.overlay,modal:b.modal,overlayClass:b.overlayClass,toTop:b.toTop,onHide:function(a){ma.call(u,"formProp",y,a)}});aa||a("."+H(b.overlayClass)).click(function(){if(!l())return!1;U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});a(".fm-button",w).hover(function(){a(this).addClass(sa)},function(){a(this).removeClass(sa)});
a("#sData",A).click(function(){g={};a("#FormError",C).hide();d();"_empty"===g[z+"_id"]?e():!0===b.checkOnSubmit?(V=k(g,b._savedData))?(a(y).data("disabled",!0),a(".confirm",w).show()):e():e();return!1});a("#cData",A).click(function(){if(!l())return!1;U(w,{gb:D,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal,formprop:!b.recreateForm,form:b.form});return!1});a("#nData",A).click(function(){if(!l())return!1;a("#FormError",C).hide();var b=f();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!W("onclickPgButtons",
"next",a(y),b[1][b[0]]))return!1;h(b[1][b[0]+1],y);F.call(u,b[1][b[0]+1]);W("afterclickPgButtons","next",a(y),b[1][b[0]+1]);E(b[0]+1,b)}return!1});a("#pData",A).click(function(){if(!l())return!1;a("#FormError",C).hide();var b=f();if(-1!==b[0]&&b[1][b[0]-1]){if(!W("onclickPgButtons","prev",a(y),b[1][b[0]])||T(a("#"+H(b[1][b[0]-1])),P))return!1;h(b[1][b[0]-1],y);F.call(u,b[1][b[0]-1]);W("afterclickPgButtons","prev",a(y),b[1][b[0]-1]);E(b[0]-1,b)}return!1});W("afterShowForm",a(y),I);B=f();E(B[0],B)}}})},
viewGridRow:function(n,Q){return this.each(function(){function d(){!0!==f.closeOnEscape&&!0!==f.navkeys[0]||setTimeout(function(){a("#cData").focus()},0)}function m(b,c,d){var e,m,h,n=0,r,t,A=[],B=G.getInd.call(l,b),w;w=J.call(k,"dialog.viewData","DataTD form-view-data");var u=J.call(k,"dialog.viewLabel","CaptionTD form-view-label"),x="<td class='"+u+"' width='"+f.labelswidth+"'>&#160;</td><td class='"+w+" ui-helper-reset'>&#160;</td>",y="",u="<td class='"+u+"'></td><td class='"+w+"'></td>",D=["integer",
"number","currency"],z=0,C=0,E,F,q;for(w=1;w<=d;w++)y+=1===w?x:u;a(K).each(function(){(m=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)||"right"!==this.align||(this.formatter&&-1!==a.inArray(this.formatter,D)?z=Math.max(z,parseInt(this.width,10)):C=Math.max(C,parseInt(this.width,10)))});E=0!==z?z:0!==C?C:0;a(K).each(function(b){e=this.name;F=!1;t=(m=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";q="boolean"!==typeof this.viewable?
!0:this.viewable;if("cb"!==e&&"subgrid"!==e&&"rn"!==e&&q){r=!1===B?"":p.getDataFieldOfCell.call(k,k.rows[B],b).html();F="right"===this.align&&0!==E?!0:!1;var g=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),f=parseInt(g.rowpos,10)||n+1,l=parseInt(2*(parseInt(g.colpos,10)||1),10);if(g.rowabove){var w=a("<tr><td class='contentinfo' colspan='"+2*d+"'>"+g.rowcontent+"</td></tr>");a(c).append(w);w[0].rp=f}h=a(c).find("tr[data-rowpos="+f+"]");0===h.length&&(h=a("<tr "+t+" data-rowpos='"+
f+"'></tr>").addClass("FormData").attr("id","trv_"+e),a(h).append(y),a(c).append(h),h[0].rp=f);g=void 0===g.label?v.colNames[b]:g.label;f=a("td:eq("+(l-1)+")",h[0]);a("td:eq("+(l-2)+")",h[0]).html("<b>"+(g||"&nbsp;")+"</b>");f[ia(f.html())?"html":"append"]("<span>"+(r||"&nbsp;")+"</span>").attr("id","v_"+e);F&&a("td:eq("+(l-1)+") span",h[0]).css({"text-align":"right",width:E+"px"});A[n]=b;n++}});0<n&&(b=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*
d-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>"),b[0].rp=n+99,a(c).append(b));return A}function h(b){var c,d,f=0,e=G.getInd.call(l,b,!0),h;e&&(a("td",e).each(function(b){h=K[b];c=h.name;d=h.editrules&&!0===h.editrules.edithidden?!1:!0===h.hidden?!0:!1;"cb"!==c&&"subgrid"!==c&&"rn"!==c&&(c=H("v_"+c),a("#"+c+" span",u).html(p.getDataFieldOfCell.call(k,e,b).html()),d&&a("#"+c,u).parents("tr:first").hide(),f++)}),0<f&&a("#id_g",u).val(b))}function c(b,
c){var d=c[1].length-1;0===b?a("#pData",t).addClass(w):void 0!==c[1][b-1]&&T(a("#"+H(c[1][b-1])),w)?a("#pData",t).addClass(w):a("#pData",t).removeClass(w);b===d?a("#nData",t).addClass(w):void 0!==c[1][b+1]&&T(a("#"+H(c[1][b+1])),w)?a("#nData",t).addClass(w):a("#nData",t).removeClass(w)}function e(){var b=G.getDataIDs.call(l),c=a("#id_g",u).val();return[a.inArray(c,b),b]}var k=this,l=a(k),v=k.p;if(k.grid&&null!=v&&n){var E=v.id,f=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",
drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"30%",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view"},G.getGridRes.call(l,"view"),p.view||{},v.formViewing||{},Q||{}),r="#ViewGrid_"+H(E),u="#ViewTbl_"+H(E),t=u+"_2",z="ViewGrid_"+E,L="ViewTbl_"+E,F=f.commonIconClass,E={themodal:"viewmod"+E,modalhead:"viewhd"+E,modalcontent:"viewcnt"+E,resizeAlso:z},b="#"+H(E.themodal),y=v.gBox,K=v.colModel,x=1,C=0,A=function(){var b=
a.makeArray(arguments);b.unshift("");b.unshift("View");b.unshift(f);return ja.apply(k,b)},B=O.call(k,"hover"),w=O.call(k,"disabled");f.recreateForm||l.data("viewProp")&&a.extend(f,l.data("viewProp"));var D=isNaN(f.dataheight)?f.dataheight:f.dataheight+"px",R=isNaN(f.datawidth)?f.datawidth:f.datawidth+"px",z=a("<div class='"+J.call(k,"dialog.body")+"'><form name='FormPost' id='"+z+"' class='FormGrid' style='width:"+R+";overflow:auto;position:relative;height:"+D+";'></form></div>"),D=z.children("form.FormGrid"),
N=a("<table id='"+L+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");a(K).each(function(){var a=this.formoptions;x=Math.max(x,a?a.colpos||0:0);C=Math.max(C,a?a.rowpos||0:0)});D.append(N);if(A("beforeInitData",D)){m(n,N,x);var da=(D="rtl"===v.direction?!0:!1)?"pData":"nData",R=M.call(k,D?"nData":"pData","",S(F,f.prevIcon),"","left"),da=M.call(k,da,"",S(F,f.nextIcon),"","right"),Y=M.call(k,"cData",f.bClose);if(0<C){var Z=[];a.each(a(N)[0].rows,
function(a,b){Z[a]=b});Z.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(Z,function(b,c){a("tbody",N).append(c)})}f.gbox=y;L=a("<div></div>").append(z).append("<div class='"+J.call(k,"dialog.footer")+"'><table border='0' class='EditTable' id='"+L+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+v.direction+"' width='"+(f.labelswidth||"auto")+"'>"+(D?da+R:R+da)+"</td><td class='EditButton EditButton-"+v.direction+"'>"+Y+"</td></tr></tbody></table></div>");p.createModal.call(k,
E,L,f,v.gView,a(v.gView)[0]);f.viewPagerButtons||a("#pData, #nData",t).hide();L=null;a(b).keydown(function(c){var d,e;if(!0===a(r).data("disabled"))return!1;if(13===c.which&&(d=a(t).find(":focus"),e=d.attr("id"),0<d.length&&0<=a.inArray(e,["pData","nData","cData"])))return d.trigger("click"),!1;if(27===c.which)return f.closeOnEscape&&p.hideModal(b,{gb:y,jqm:f.jqModal,onClose:f.onClose,removemodal:f.removemodal,formprop:!f.recreateForm,form:f.form}),!1;if(!0===f.navkeys[0]){if(c.which===f.navkeys[1])return a("#pData",
t).trigger("click"),!1;if(c.which===f.navkeys[2])return a("#nData",t).trigger("click"),!1}});ca(a("#cData",t),f.closeicon,F);A("beforeShowForm",a(r));p.viewModal.call(k,b,{gbox:y,jqm:f.jqModal,overlay:f.overlay,toTop:f.toTop,modal:f.modal,onHide:function(a){ma.call(l,"viewProp",r,a)}});a(".fm-button:not(."+w.split(" ").join(".")+")",t).hover(function(){a(this).addClass(B)},function(){a(this).removeClass(B)});d();a("#cData",t).click(function(){p.hideModal(b,{gb:y,jqm:f.jqModal,onClose:f.onClose,removemodal:f.removemodal,
formprop:!f.recreateForm,form:f.form});return!1});a("#nData",t).click(function(){a("#FormError",u).hide();var b=e();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!A("onclickPgButtons","next",a(r),b[1][b[0]]))return!1;h(b[1][b[0]+1]);G.setSelection.call(l,b[1][b[0]+1]);A("afterclickPgButtons","next",a(r),b[1][b[0]+1]);c(b[0]+1,b)}d();return!1});a("#pData",t).click(function(){a("#FormError",u).hide();var b=e();if(-1!==b[0]&&b[1][b[0]-1]){if(!A("onclickPgButtons","prev",a(r),b[1][b[0]]))return!1;
h(b[1][b[0]-1]);G.setSelection.call(l,b[1][b[0]-1]);A("afterclickPgButtons","prev",a(r),b[1][b[0]-1]);c(b[0]-1,b)}d();return!1});F=e();c(F[0],F)}}})},delGridRow:function(n,Q){return this.each(function(){var d=this,m=d.p,h=a(d);if(d.grid&&null!=m&&n){var c=m.id,e=a.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,
afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},G.getGridRes.call(h,"del"),p.del||{},m.formDeleting||{},Q||{}),k="DelTbl_"+c,l="#DelTbl_"+H(c),v,E,f,r,u={themodal:"delmod"+c,modalhead:"delhd"+c,modalcontent:"delcnt"+c,resizeAlso:k},t="#"+H(u.themodal),z=m.gBox,L=e.commonIconClass,F=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("Delete");b.unshift(e);return ja.apply(d,b)},b=O.call(d,"hover"),y=O.call(d,
"active"),K=O.call(d,"error");a.isArray(n)||(n=[String(n)]);if(void 0!==a(t)[0]){if(!F("beforeInitData",a(l)))return;a("#DelData>td",l).text(n.join()).data("rowids",n);a("#DelError",l).hide();!0===e.processing&&(e.processing=!1,a("#dData",l).removeClass(y));F("beforeShowForm",a(l));p.viewModal.call(d,t,{gbox:z,jqm:e.jqModal,jqM:!1,overlay:e.overlay,toTop:e.toTop,modal:e.modal})}else{var x=isNaN(e.dataheight)?e.dataheight:e.dataheight+"px",C=isNaN(e.datawidth)?e.datawidth:e.datawidth+"px",x="<div class='"+
J.call(d,"dialog.body")+"'><div id='"+k+"' class='formdata' style='width:"+C+";overflow:auto;position:relative;height:"+x+";'>",x=x+"<table class='DelTable'><tbody>"+("<tr id='DelError' style='display:none'><td class='"+K+"'></td></tr>"),x=x+("<tr id='DelData' style='display:none'><td >"+n.join()+"</td></tr>"),x=x+("<tr><td class='delmsg' style='white-space:pre;'>"+e.msg+"</td></tr>"),x=x+"</tbody></table></div></div>",K=M.call(d,"dData",e.bSubmit),C=M.call(d,"eData",e.bCancel),x=x+("<div class='"+
J.call(d,"dialog.footer")+"'><table"+(p.msie&&8>p.msiever()?" cellspacing='0'":"")+" class='EditTable' id='"+k+"_2'><tbody><tr><td><hr class='"+J.call(d,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+m.direction+"'>"+K+"&#160;"+C+"</td></tr></tbody></table></div>");e.gbox=z;p.createModal.call(d,u,x,e,m.gView,a(m.gView)[0]);a("#DelData>td",l).data("rowids",n);if(!F("beforeInitData",a(x)))return;a(".fm-button",l+"_2").hover(function(){a(this).addClass(b)},
function(){a(this).removeClass(b)});ca(a("#dData",l+"_2"),e.delicon,L);ca(a("#eData",l+"_2"),e.cancelicon,L);a("#dData",l+"_2").click(function(){var b=[!0,""],k,n=a("#DelData>td",l),u=n.text(),x=n.data("rowids"),n={};a.isFunction(e.onclickSubmit)&&(n=e.onclickSubmit.call(d,e,u)||{});a.isFunction(e.beforeSubmit)&&(b=e.beforeSubmit.call(d,u)||b);if(b[0]&&!e.processing){e.processing=!0;f=m.prmNames;v=a.extend({},e.delData,n);r=f.oper;v[r]=f.deloper;E=f.id;u=x.slice();if(!u.length)return!1;for(k in u)u.hasOwnProperty(k)&&
(u[k]=p.stripPref(m.idPrefix,u[k]));v[E]=u.join();a(this).addClass(y);k=e.url||m.editurl;k=a.extend({url:a.isFunction(k)?k.call(d,v[E],v,e):k,type:e.mtype,data:a.isFunction(e.serializeDelData)?e.serializeDelData.call(d,v):v,complete:function(c,f){var k;a("#dData",l+"_2").removeClass(y);300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(b[0]=!1,a.isFunction(e.errorTextFormat)?b[1]=e.errorTextFormat.call(d,c):b[1]=f+" Status: '"+c.statusText+"'. Error code: "+c.status):a.isFunction(e.afterSubmit)&&
(b=e.afterSubmit.call(d,c,v)||[!0]);if(!1===b[0])a("#DelError>td",l).html(b[1]),a("#DelError",l).show();else{if(e.reloadAfterSubmit&&"local"!==m.datatype)h.trigger("reloadGrid",[a.extend({},e.reloadGridOptions||{})]);else if(!0===m.treeGrid)try{G.delTreeNode.call(h,x[0])}catch(n){}else for(x=x.slice(),k=0;k<x.length;k++)G.delRowData.call(h,x[k]);setTimeout(function(){F("afterComplete",c,u,a(l))},50)}e.processing=!1;b[0]&&p.hideModal(t,{gb:z,jqm:e.jqModal,onClose:e.onClose,removemodal:e.removemodal})}},
p.ajaxOptions,e.ajaxDelOptions);k.url||e.useDataProxy||(a.isFunction(m.dataProxy)?e.useDataProxy=!0:(b[0]=!1,b[1]+=" "+p.errors.nourl));b[0]&&(e.useDataProxy?(k=m.dataProxy.call(d,k,"del_"+c),void 0===k&&(k=[!0,""]),!1===k[0]?(b[0]=!1,b[1]=k[1]||"Error deleting the selected row!"):p.hideModal(t,{gb:z,jqm:e.jqModal,onClose:e.onClose,removemodal:e.removemodal})):"clientArray"===k.url?(v=k.data,k.complete({status:200,statusText:""},"")):a.ajax(k))}!1===b[0]&&(a("#DelError>td",l).html(b[1]),a("#DelError",
l).show());return!1});a("#eData",l+"_2").click(function(){p.hideModal(t,{gb:z,jqm:e.jqModal,onClose:e.onClose,removemodal:e.removemodal});return!1});F("beforeShowForm",a(l));p.viewModal.call(d,t,{gbox:z,jqm:e.jqModal,overlay:e.overlay,toTop:e.toTop,modal:e.modal})}F("afterShowForm",a(l));!0===e.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+H(u.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(n,Q,d,m,h,c,e){"object"===typeof n&&(e=c,c=h,h=m,m=d,d=Q,Q=n,
n=void 0);m=m||{};d=d||{};e=e||{};h=h||{};c=c||{};return this.each(function(){var k=this,l=k.p,v=a(k);if(k.grid&&null!=l&&!(k.nav&&0<a(n).find(".navtable").length)){var E=l.id,f=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},G.getGridRes.call(v,"nav"),p.nav||
{},l.navOptions||{},Q||{});f.position=f.position||("rtl"===l.direction?"right":"left");var r,u=l.idSel,t=l.gBox,z=f.commonIconClass,L={themodal:"alertmod_"+E,modalhead:"alerthd_"+E,modalcontent:"alertcnt_"+E},F=function(){return function(){var b=document.documentElement,c=window,d=1024,e=768,g=v.closest(".ui-jqgrid").offset();void 0===a("#"+H(L.themodal))[0]&&(f.alerttop||f.alertleft||(void 0!==c.innerWidth?(d=c.innerWidth,e=c.innerHeight):null!=b&&void 0!==b.clientWidth&&0!==b.clientWidth&&(d=b.clientWidth,
e=b.clientHeight),d=d/2-parseInt(f.alertwidth,10)/2-g.left,e=e/2-25-g.top),p.createModal.call(k,L,"<div>"+f.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='"+E+"_jqg_alrt'></span></span>",{gbox:t,jqModal:f.jqModal,drag:!0,resize:!0,caption:f.alertcap,top:null!=f.alerttop?f.alerttop:e,left:null!=f.alertleft?f.alertleft:d,width:f.alertwidth,height:f.alertheight,closeOnEscape:f.closeOnEscape,zIndex:f.alertzIndex,removemodal:f.removemodal},l.gView,a(t)[0],!1));p.viewModal.call(k,"#"+H(L.themodal),
{gbox:t,toTop:f.alertToTop,jqm:f.jqModal});var h=a("#"+H(L.modalhead)).find(".ui-jqdialog-titlebar-close");h.attr({tabindex:"0",href:"#",role:"button"});setTimeout(function(){h.focus()},50)}}(),b,y=function(b){if(13===b.which&&(b=a(this).find(".ui-pg-button").filter(":focus"),0<b.length)){var c=b[0].id,c=c.substr(0,0<a(this).closest(".ui-jqgrid-toppager").length?c.length-E.length-5:c.length-E.length-1)+"mod"+l.id,d=a(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(0>a.inArray(c,
d))return b.trigger("click"),!1}},K=O.call(k,"hover"),x=O.call(k,"disabled"),C=J.call(k,"navButton","ui-pg-button");if(k.grid){k.modalAlert=F;void 0===n&&(l.pager?(n=l.pager,l.toppager&&(f.cloneToTop=!0)):l.toppager&&(n=l.toppager));var A=1,B,w,D,R,N,M=["left","center","right"],Y="<div class='"+J.call(k,"navButton","ui-pg-button "+O.call(k,"disabled"))+"'><span class='ui-separator'></span></div>",Z=function(){T(this,x)||a(this).addClass(K)},g=function(){a(this).removeClass(K)},V=function(){T(this,
x)||(a.isFunction(f.addfunc)?f.addfunc.call(k):G.editGridRow.call(v,"new",m));return!1},I=function(b,c,d){if(!T(this,x)){var e=l.selrow;e?a.isFunction(b)?b.call(k,e):G[c].call(v,e,d):F()}return!1},fa=function(){return I.call(this,f.editfunc,"editGridRow",d)},U=function(){return I.call(this,f.viewfunc,"viewGridRow",e)},ea=function(){var b;T(this,x)||(l.multiselect?(b=l.selarrrow,0===b.length&&(b=null)):b=l.selrow,b?a.isFunction(f.delfunc)?f.delfunc.call(k,b):G.delGridRow.call(v,b,h):F());return!1},
W=function(){T(this,x)||(a.isFunction(f.searchfunc)?f.searchfunc.call(k,c):G.searchGrid.call(v,c));return!1},ca=function(){if(!T(this,x)){a.isFunction(f.beforeRefresh)&&f.beforeRefresh.call(k);l.search=!1;l.resetsearch=!0;try{if("currentfilter"!==f.refreshstate){l.postData.filters="";try{a("#fbox_"+u).jqFilter("resetFilter")}catch(b){}a.isFunction(k.clearToolbar)&&k.clearToolbar(!1)}}catch(b){}switch(f.refreshstate){case "firstpage":v.trigger("reloadGrid",[a.extend({},f.reloadGridOptions||{},{page:1})]);
break;case "current":case "currentfilter":v.trigger("reloadGrid",[a.extend({},f.reloadGridOptions||{},{current:!0})])}a.isFunction(f.afterRefresh)&&f.afterRefresh.call(k)}return!1},P=function(b,c,d,e,h){var k=a("<div class='"+C+"' tabindex='0' role='button'></div>"),l=f[b+"icon"],m=a.trim(f[b+"text"]);k.append("<div class='ui-pg-div'><span class='"+(f.iconsOverText?S("ui-pg-button-icon-over-text",z,l):S(z,l))+"'></span>"+(m?"<span class='ui-pg-button-text"+(f.iconsOverText?" ui-pg-button-icon-over-text":
"")+"'>"+m+"</span>":"")+"</div>");a(e).append(k);k.attr({title:f[b+"title"]||"",id:c||b+"_"+h}).click(d).hover(Z,g);return k};f.cloneToTop&&l.toppager&&(A=2);for(B=0;B<A;B++){b=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===l.direction?"right":"left")+";table-layout:auto;'></div>");0===B?(w=n,D=E,w===l.toppager&&(D+="_top",A=1)):(w=l.toppager,D=E+"_top");f.add&&P("add",m.id,V,b,D);f.edit&&P("edit",d.id,fa,b,D);f.view&&P("view",e.id,U,b,D);f.del&&P("del",h.id,ea,b,D);
(f.add||f.edit||f.del||f.view)&&a(b).append(Y);f.search&&(r=P("search",c.id,W,b,D),c.showOnLoad&&!0===c.showOnLoad&&a(r,b).click());f.refresh&&P("refresh","",ca,b,D);r=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px";a("body").append("<div id='testpg2' class='"+J.call(k,"gBox","ui-jqgrid")+"' style='font-size:"+r+";visibility:hidden;' ></div>");r=a(b).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(w+"_"+f.position,w).append(b);if(f.hideEmptyPagerParts)for(D=0;D<M.length;D++)M[D]!==
f.position&&(N=a(w+"_"+M[D],w),0===N.length||0===N[0].childNodes.length?N.hide():1===N[0].childNodes.length&&(R=N[0].firstChild,!a(R).is("table.ui-pg-table")||0!==R.rows&&0!==R.rows[0].cells.length||N.hide()));l._nvtd&&(r>l._nvtd[0]&&(a(w+"_"+f.position,w).width(r),l._nvtd[0]=r),l._nvtd[1]=r);k.nav=!0;b.bind("keydown.jqGrid",y)}v.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(n,Q){"object"===typeof n&&(Q=n,n=void 0);return this.each(function(){var d=this,m=d.p;if(d.grid){var h=
a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",cursor:"pointer",iconsOverText:!1},G.getGridRes.call(a(d),"nav"),p.nav||{},m.navOptions||{},Q||{}),c=O.call(d,"hover"),e=O.call(d,"disabled"),k=J.call(d,"navButton","ui-pg-button");if(void 0===n)if(m.pager)if(G.navButtonAdd.call(a(d),m.pager,h),m.toppager)n=m.toppager;else return;else m.toppager&&(n=m.toppager);"string"===typeof n&&0!==n.indexOf("#")&&(n="#"+H(n));var m=a(".navtable",n),l=h.commonIconClass;if(0<m.length&&!(h.id&&
0<m.find("#"+H(h.id)).length)){var v=a("<div tabindex='0' role='button'></div>");"NONE"===h.buttonicon.toString().toUpperCase()?a(v).addClass(k).append("<div class='ui-pg-div'>"+(h.caption?"<span class='ui-pg-button-text"+(h.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+h.caption+"</span>":"")+"</div>"):a(v).addClass(k).append("<div class='ui-pg-div'><span class='"+(h.iconsOverText?S("ui-pg-button-icon-over-text",l,h.buttonicon):S(l,h.buttonicon))+"'></span>"+(h.caption?"<span class='ui-pg-button-text"+
(h.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+h.caption+"</span>":"")+"</div>");h.id&&a(v).attr("id",h.id);"first"===h.position&&0<m.children("div.ui-pg-button").length?m.children("div.ui-pg-button").first().before(v):m.append(v);a(v,m).attr("title",h.title||"").click(function(c){T(this,e)||a.isFunction(h.onClickButton)&&h.onClickButton.call(d,h,c);return!1}).hover(function(){T(this,e)||a(this).addClass(c)},function(){a(this).removeClass(c)});a(d).triggerHandler("jqGridResetFrozenHeights")}}})},
navSeparatorAdd:function(n,p){p=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},p||{});return this.each(function(){if(this.grid){var d=this.p,m=J.call(this,"navButton","ui-pg-button "+O.call(this,"disabled"));if(void 0===n)if(d.pager)if(G.navSeparatorAdd.call(a(this),d.pager,p),d.toppager)n=d.toppager;else return;else d.toppager&&(n=d.toppager);"string"===typeof n&&0!==n.indexOf("#")&&(n="#"+H(n));d=a(".navtable",n);0<d.length&&(m="<div class='"+m+"'><span class='"+p.sepclass+"'></span>"+
p.sepcontent+"</div>","first"===p.position?0===d.children("div.ui-pg-button").length?d.append(m):d.children("div.ui-pg-button").first().before(m):d.append(m))}})},GridToForm:function(n,p){return this.each(function(){var d,m,h,c;if(this.grid){var e=G.getRowData.call(a(this),n),k=this.p.propOrAttr;if(e)for(d in e)if(e.hasOwnProperty(d))if(m=a("[name="+H(d)+"]",p),m.is("input:radio")||m.is("input:checkbox"))for(h=0;h<m.length;h++)c=a(m[h]),c[k]("checked",c.val()===String(e[d]));else m.val(ia(e[d])?"":
e[d])}})},FormToGrid:function(n,p,d,m){return this.each(function(){if(this.grid){d||(d="set");m||(m="first");var h=a(p).serializeArray(),c={};a.each(h,function(a,d){c[d.name]=d.value});"add"===d?G.addRowData.call(a(this),n,c,m):"set"===d&&G.setRowData.call(a(this),n,c)}})}})});
//# sourceMappingURL=grid.formedit.map
